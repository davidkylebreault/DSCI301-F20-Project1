---
title: "CleanData.R"
author: "David Kyle Breault"
date: "9/26/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(here)
library(readr)
```

Obtained multiple datasets of the same variables in order to have a larger collection of data. Added a column saying where the data was gathered from. Then join them.

zoo.csv: 18 columns, 101 rows.
What does it measure: Dataset containing information on a variety of animal species that could be helpful in machine learning. This data for this project will not be used for machine learning, but will instead be interpreted by a person to look for relationships. This data is used for classification, in other words, based off of what anatomical features this species has, how should it be listed taxonomically?

How was it collected: Dataset was collected from a zoo (unspecified). Collected by UCI Machine Learning (https://www.kaggle.com/uciml/zoo-animal-classification/metadata)

18 columns, with hair, feathers, eggs, milk, airborne, aquatic, predator, toothed, backbone, breahtes, venomous, fins, tail, domestic, and catsize being boolean. animal_name is unique for each row, and class_type is numeric, but represents a specific character (species type). legs are numeric, and are in values of 0,2,4,6,8.

What columns will I make use of?
Will include a row that specifies where this data came from.

zoo2.csv: 18 columns, 43 rows

What does it measure: an extension of the originial zoo.csv dataset with more species that are not mammals or birds in order to help make a more diverse dataset to determine what pararameters are important for classifying species.

How ws it collected: unspecified. Collected by Rodrigo Hjort (https://www.kaggle.com/agajorte/zoo-animals-extended-dataset)

Will include row that specifies where the data came from

zoo3.csv: 18 columns, 70 rows

What does it measure: an extension of the original zoo.csv dataset with more species being mainly animals from brazil that are in danger of extinction

How was it collected: SÃ£o Paulo Zoo. Collected by Rodrigo Hjort (https://www.kaggle.com/agajorte/zoo-animals-extended-dataset)

Will include row that specifies where the data came from

```{r}
Project1.here <- ("zoo.csv")
Project1 <- read_csv(Project1.here,
                     col_types = cols(
  animal_name = col_character(),
  hair = col_logical(),
  feathers = col_logical(),
  eggs = col_logical(),
  milk = col_logical(),
  airborne = col_logical(),
  aquatic = col_logical(),
  predator = col_logical(),
  toothed = col_logical(),
  backbone = col_logical(),
  breathes = col_logical(),
  venomous = col_logical(),
  fins = col_logical(),
  legs = col_double(),
  tail = col_logical(),
  domestic = col_logical(),
  catsize = col_logical(),
  class_type = col_character()
))
```

```{r}
Project1[,"data origin"] <- "zoo.csv"

## Code from http://www.cookbook-r.com/Manipulating_data/Adding_and_removing_columns_from_a_data_frame/
```

```{r}
Project1$animal_name <- sub(" ", "_", Project1$animal_name)

## Code from https://stackoverflow.com/questions/53107014/replace-space-between-two-words-with-an-underscore-in-a-vector
```

Load zoo2.csv

```{r}
Project1.2.here <- ("zoo2.csv")
Project1.2 <- read_csv(Project1.2.here,
                     col_types = cols(
  animal_name = col_character(),
  hair = col_logical(),
  feathers = col_logical(),
  eggs = col_logical(),
  milk = col_logical(),
  airborne = col_logical(),
  aquatic = col_logical(),
  predator = col_logical(),
  toothed = col_logical(),
  backbone = col_logical(),
  breathes = col_logical(),
  venomous = col_logical(),
  fins = col_logical(),
  legs = col_double(),
  tail = col_logical(),
  domestic = col_logical(),
  catsize = col_logical(),
  class_type = col_character()
))
```


```{r}
Project1.2[,"data origin"] <- "zoo2.csv"

## Code from http://www.cookbook-r.com/Manipulating_data/Adding_and_removing_columns_from_a_data_frame/
```


```{r}
Project1.2$animal_name <- sub(" ", "_", Project1.2$animal_name)

## Code from https://stackoverflow.com/questions/53107014/replace-space-between-two-words-with-an-underscore-in-a-vector
```

Load zoo3.csv

```{r}
Project1.3.here <- here("zoo3.csv")
Project1.3 <- read_csv(Project1.3.here,
                     col_types = cols(
  animal_name = col_character(),
  hair = col_logical(),
  feathers = col_logical(),
  eggs = col_logical(),
  milk = col_logical(),
  airborne = col_logical(),
  aquatic = col_logical(),
  predator = col_logical(),
  toothed = col_logical(),
  backbone = col_logical(),
  breathes = col_logical(),
  venomous = col_logical(),
  fins = col_logical(),
  legs = col_double(),
  tail = col_logical(),
  domestic = col_logical(),
  catsize = col_logical(),
  class_type = col_character()
))
```

```{r}
Project1.3[,"data origin"] <- "zoo3.csv"

## Code from http://www.cookbook-r.com/Manipulating_data/Adding_and_removing_columns_from_a_data_frame/
```

```{r}
Project1.3$animal_name <- sub(" ", "_", Project1.3$animal_name)

## Code from https://stackoverflow.com/questions/53107014/replace-space-between-two-words-with-an-underscore-in-a-vector
```

zoo.final has a total of 19 columns (the original 18 plus the mutated column) and 214 rows

```{r}
zoo.final <- Project1%>%
  full_join(Project1.2)%>%
  full_join(Project1.3)

## Code from R for Datascience by Hadley Wickham & Garrett Grolemund, Chapter 10: Relational Data with dplyr
```


For class_types, the names are numeric but represent character values (species type) so adding a row representing this may be helpful. This will be done by using the class_type names as specified in the data summary. 1 being mammal, 2 bird, 3 reptile, 4 fish, 5 amphibian, 6 insect, 7 non-insect invertebrate (Note: 6 is bug in the data summary, and 7 is invertebrate in the data summary. However, all bugs are insects, but not all insects are bugs, and for class_type 6, insect is more accurate given the species in the data set (as some of the species given are insects but not bugs). For 7, invertebrate is too broad of a term, as that includes insects, so this name designation was given non insect invertebrates as a result)

```{r}

## Give a new column called species_type to more accurately reflect the type of species
zoo.final <- zoo.final%>%
  mutate(species_type=
           case_when(
    class_type=="1"~"mammal",
    class_type=="2"~"bird",
    class_type=="3"~"reptile",
    class_type=="4"~"fish",
    class_type=="5"~"amphibian",
    class_type=="6"~"insect",
    class_type=="7"~"non-insect invertebrate"
  ))
```

## two datasets were merged together, so will need to look at the specific metadata for both

## Combined zoo.csv, zoo2.csv, and zoo3.csv from Kaggle

#3 can maybe explore the relatedness of species

# relationship between catsize and domestic

```{r}
zoo.final %>%
  group_by(species_type) %>%
  summarize(Percent_venomous = mean(venomous)) %>%
  ggplot()+
  geom_col(aes(y=Percent_venomous,x=species_type,fill=species_type))+
  labs(title="Species that are Venomous",
       x="Class Type",
       y="Percent of Venomous Species", fill = "Species")

## Which species has the most overall data entries? can say that because reptiles have more will explore that into more detail
```

Most of the species that are venomous in this dataset are non insect invertebrates. What species are contributing to this distribution? What species are driving this up (for example, archnids)? Also most amphibians are not venomous, so what is going on with that? Could they have been mistaken for posionous (venomous: It bites you, you die vs. poisonous: you bite it you die.)

```{r}
## What is going on with the amphibians?

zoo.final%>%
  group_by(species_type)%>%
  select(animal_name,species_type,venomous)%>%
  filter(venomous==TRUE, species_type=="amphibian")

```

The sample size for the amphibians species was small enought that the results for the percentages was skewed. Due to this there are only three entries for the amphibians that are venomous.`frog` cannot be looked at in further detail, because it is not specified in zoo.csv. However, ra-flecha-azul (which is portugese) is also known as the blue arrow frog, which is poisionous. Sapo-cururu is portugese for Rhinella icterica, which also poisionous, not venomous.

## WILL NEED TO CHANGE THAT TO FALSE

```{r}
zoo.final%>%
  group_by(species_type)%>%
  filter(animal_name=="frog")
```

The species 'frog' came from two different datasets. Looking at the data spreadsheets the first term got dropped from the 'frog' name. For zoo2.csv one should be the tree frog, the other dart frog. For zoo.csv, both frogs are listed as 'frog' but have different data values, which leads me to believe they are different species which were not specified. In addition, were all species that had a two part name have the first name dropped once the data was uploaded? This could be due to the space in the name.

```{r}
## Check with a different species found in zoo.csv if it dropped the 'wart' in toad
zoo.final%>%
  group_by(species_type)%>%
  filter(animal_name=="toad")
```


```{r}
## What non insect invertebrates are driving up the percentage?

zoo.final%>%
  filter(species_type=="non-insect invertebrate")
```



```{r}
zoo.final%>%
  filter(species_type=="reptile", legs=="0")%>%
  select(animal_name,species_type,venomous)%>%
    mutate(snake=
           case_when(
    species_type=="reptile"~"snake"))->snake

## One species incldued, being slowworm is a legless lizard, but for sake of this analysis will be treated as a snake

zoo.final%>%
  filter(species_type=="reptile", legs=="4")%>%
  select(animal_name,species_type,venomous)%>%
    mutate(snake=
           case_when(
    species_type=="reptile"~"non_snake"))->non_snake

## Join the data together
  
snakevslizard<- snake%>%
  full_join(non_snake)
  
```

```{r}
snakevslizard%>%
  group_by(snake)%>%
  ggplot()+
  geom_bar(mapping=aes(x=snake, y=snake, fill=venomous))

help(geom_bar)

```


```{r}
zoo.final%>%
  group_by(species_type)%>%
  select(animal_name,domestic,catsize)%>%
  filter(domestic==FALSE, catsize==TRUE)%>%
  count()
 
```

# Should figure out the total amount of species in the data of each type
# venemous by species type

This dataset is constrained by the sample size. Even with the added data entries signifigant anaylsis is limited. An even larger data set with a randomization of species (not constrained to ones at a zoo) may be better for machine learning and classification purposes. In addition, some of the information is not classified correctly (such as venomous in amphibians, which may skew the ability of proper machine learning.)